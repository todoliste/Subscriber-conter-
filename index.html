<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vocal Temps R√©el + Deep Voice</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
  button { margin: 5px; padding: 10px 20px; font-size: 16px; }
  label { display: block; margin-top: 15px; }
</style>
</head>
<body>
<h2>Enregistrement Vocal en Temps R√©el + Voix Grave</h2>

<button id="startBtn">üé§ D√©marrer</button>
<button id="stopBtn" disabled>‚èπ Arr√™ter</button>

<label for="pitch">Modifier la voix (grave <-> aigu) :</label>
<input type="range" id="pitch" min="0.5" max="1.5" step="0.01" value="1">
<span id="pitchValue">1</span>

<script>
let audioContext;
let stream;
let sourceNode;
let pitchNode;

const startBtn = document.getElementById('startBtn');
const stopBtn = document.getElementById('stopBtn');
const pitchSlider = document.getElementById('pitch');
const pitchValue = document.getElementById('pitchValue');

startBtn.onclick = async () => {
    stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    audioContext = new (window.AudioContext || window.webkitAudioContext)();

    sourceNode = audioContext.createMediaStreamSource(stream);

    // On cr√©e un BiquadFilter pour simuler un effet grave
    pitchNode = audioContext.createBiquadFilter();
    pitchNode.type = 'lowshelf';
    pitchNode.frequency.value = 200; // fr√©quence de base pour le grave
    pitchNode.gain.value = 0;

    sourceNode.connect(pitchNode);
    pitchNode.connect(audioContext.destination);

    startBtn.disabled = true;
    stopBtn.disabled = false;

    // Limite 10 min
    setTimeout(() => {
        if (!stopBtn.disabled) stopBtn.click();
    }, 10 * 60 * 1000);
};

stopBtn.onclick = () => {
    if (stream) {
        stream.getTracks().forEach(track => track.stop());
    }
    if (audioContext) {
        audioContext.close();
    }
    startBtn.disabled = false;
    stopBtn.disabled = true;
};

// Slider pour modifier le pitch en temps r√©el
pitchSlider.oninput = () => {
    pitchValue.textContent = pitchSlider.value;
    if (pitchNode) {
        // plus la valeur est basse, plus la voix devient grave
        pitchNode.gain.value = -40 * (1 - pitchSlider.value); 
    }
};
</script>
</body>
</html>